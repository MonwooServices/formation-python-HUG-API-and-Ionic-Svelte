<html>

<body>
  <div class="results"></div>
  <!-- TEST OK -->
  <!-- TP -->
  <SCRIPT>
    const queryString = window.location.search;
    const urlParams = new URLSearchParams(queryString);
    const backendIp = urlParams.get("backendIp") || "192.168.1.100";
    const backendPort = urlParams.get("backendPort") || "8000";

    const board = document.querySelector('.results');
    const appendToBody = (html) => {
      const placeholder = document.createElement("div");
      placeholder.innerHTML = html;
      board.append(placeholder);
    }

    (async () => {
      // FAILING home page
      appendToBody(`
          <strong>TEST 1</strong> : home page errors validation in progress...
      `);

      // fetch(`http://${backendIp}:${backendPort}/api/jwt/login`, {
      await fetch(`http://${backendIp}:${backendPort}/api/buddy/send-msg`, {
        method: "POST",
        // headers: { // POUR les call qui sont DEJA authentifiÃ©
        //   ... : ... token(encoded) // Pas besoin pour le login...
        // }
        data: {
          username: 'hello', // TODO, (NEW ? UPDATE ? )
          password: 'world', // TODO, (NEW ? UPDATE ? )
        }
      }).then(
        async resp => {
          const dataResp = await resp.json(); // this returns a promise
          // TODO
          return resp;
        }).then(repos => {
          console.log(repos)
        }).catch(ex => {
          console.error(ex);
        })

      appendToBody(`
        <strong>TEST 3</strong> : DONE
    `);
    }
    )();
  </SCRIPT>

</html>